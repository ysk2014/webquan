define("editormd",["jquery","codemirror","marked","prettify","lib/codemirror/mode/gfm/gfm","lib/codemirror/mode/javascript/javascript","lib/codemirror/mode/php/php","lib/codemirror/mode/sass/sass","lib/codemirror/mode/python/python","lib/codemirror/mode/sql/sql","lib/codemirror/mode/shell/shell",],function(h,g,a,j){var h=(typeof(jQuery)!=="undefined")?jQuery:Zepto;if(typeof(h)==="undefined"){return}var k=function(m,l){return new k.fn.init(m,l)};k.title=k.$name="Editor.md";k.version="1.5.0";k.homePage="https://pandao.github.io/editor.md/";k.classPrefix="editormd-";k.toolbarModes={full:["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","table","datetime","emoji","html-entities","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"],simple:["undo","redo","|","bold","del","italic","quote","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","|","watch","preview","fullscreen","help",],mini:["undo","redo","|","watch","preview","|","help","info"]};k.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:true,watch:true,placeholder:"Enjoy Markdown! coding now...",gotoLine:true,codeFold:false,autoHeight:false,autoFocus:true,autoCloseTags:true,searchReplace:true,syncScrolling:true,readOnly:false,tabSize:4,indentUnit:4,lineNumbers:true,lineWrapping:true,autoCloseBrackets:true,showTrailingSpace:true,matchBrackets:true,indentWithTabs:true,styleSelectedText:true,matchWordHighlight:true,styleActiveLine:true,dialogLockScreen:true,dialogShowMask:true,dialogDraggable:true,dialogMaskBgColor:"#fff",dialogMaskOpacity:0.1,fontSize:"13px",saveHTMLToTextarea:false,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:false,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"",crossDomainUpload:false,uploadCallbackURL:"",toc:true,tocm:false,tocTitle:"",tocDropdown:false,tocContainer:"",tocStartLevel:1,htmlDecode:false,pageBreak:true,atLink:true,emailLink:true,taskList:false,emoji:false,tex:false,flowChart:false,sequenceDiagram:false,previewCodeHighlight:true,toolbar:true,toolbarAutoFixed:true,toolbarIcons:"simple",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return k.toolbarHandlers.ucwords},lowercase:function(){return k.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:'<a href="javascript:;" title="Lowercase" unselectable="on"><i class="fa" name="lowercase" style="font-size:24px;margin-top: -10px;">a</i></a>',"ucwords":'<a href="javascript:;" title="ucwords" unselectable="on"><i class="fa" name="ucwords" style="font-size:20px;margin-top: -3px;">Aa</i></a>'},toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:k.classPrefix+"bold",h2:k.classPrefix+"bold",h3:k.classPrefix+"bold",h4:k.classPrefix+"bold",h5:k.classPrefix+"bold",h6:k.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",help:"fa-question-circle",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"开源在线Markdown编辑器<br/>Open source online Markdown editor.",tocTitle:"目录",toolbar:{undo:"撤销（Ctrl+Z）",redo:"重做（Ctrl+Y）",bold:"粗体",del:"删除线",italic:"斜体",quote:"引用",ucwords:"将每个单词首字母转成大写",uppercase:"将所选转换成大写",lowercase:"将所选转换成小写",h1:"标题1",h2:"标题2",h3:"标题3",h4:"标题4",h5:"标题5",h6:"标题6","list-ul":"无序列表","list-ol":"有序列表",hr:"横线",link:"链接","reference-link":"引用链接",image:"添加图片",code:"行内代码","preformatted-text":"预格式文本 / 代码块（缩进风格）","code-block":"代码块（多语言风格）",table:"添加表格",datetime:"日期时间",emoji:"Emoji表情","html-entities":"HTML实体字符",pagebreak:"插入分页符","goto-line":"跳转到行",watch:"关闭实时预览",unwatch:"开启实时预览",preview:"全窗口预览HTML（按 Shift + ESC还原）",fullscreen:"全屏（按ESC还原）",clear:"清空",search:"搜索",help:"使用帮助",info:"关于"+k.title},buttons:{enter:"确定",cancel:"取消",close:"关闭"},dialog:{link:{title:"添加链接",url:"链接地址",urlTitle:"链接标题",urlEmpty:"错误：请填写链接地址。"},referenceLink:{title:"添加引用链接",name:"引用名称",url:"链接地址",urlId:"链接ID",urlTitle:"链接标题",nameEmpty:"错误：引用链接的名称不能为空。",idEmpty:"错误：请填写引用链接的ID。",urlEmpty:"错误：请填写引用链接的URL地址。"},image:{title:"添加图片",url:"图片地址",link:"图片链接",alt:"图片描述",uploadButton:"本地上传",imageURLEmpty:"错误：图片地址不能为空。",uploadFileEmpty:"错误：上传的图片不能为空。",formatNotAllowed:"错误：只允许上传图片文件，允许上传的图片文件格式有："},preformattedText:{title:"添加预格式文本或代码块",emptyAlert:"错误：请填写预格式文本或代码的内容。"},codeBlock:{title:"添加代码块",selectLabel:"代码语言：",selectDefaultText:"请选择代码语言",otherLanguage:"其他语言",unselectedLanguageAlert:"错误：请选择代码所属的语言类型。",codeEmptyAlert:"错误：请填写代码内容。"},htmlEntities:{title:"HTML 实体字符"},help:{title:"使用帮助"}}}};k.classNames={tex:k.classPrefix+"tex"};k.dialogZindex=99999;k.$katex=null;k.$marked=null;k.$CodeMirror=null;k.$prettyPrint=null;var b,d;k.prototype=k.fn={state:{watching:false,loaded:false,preview:false,fullscreen:false},init:function(n,t){t=t||{};if(typeof n==="object"){t=n}var q=this;var s=this.classPrefix=k.classPrefix;var o=this.settings=h.extend(true,k.defaults,t);n=(typeof n==="object")?o.id:n;var r=this.editor=h("#"+n);this.id=n;this.lang=o.lang;var l=this.classNames={textarea:{html:s+"html-textarea",markdown:s+"markdown-textarea"}};o.pluginPath=(o.pluginPath==="")?o.path+"../plugins/":o.pluginPath;this.state.watching=(o.watch)?true:false;if(!r.hasClass("editormd")){r.addClass("editormd")}r.css({width:(typeof o.width==="number")?o.width+"px":o.width,height:(typeof o.height==="number")?o.height+"px":o.height});if(o.autoHeight){r.css("height","auto")}var m=this.markdownTextarea=r.children("textarea");if(m.length<1){r.append("<textarea></textarea>");m=this.markdownTextarea=r.children("textarea")}m.addClass(l.textarea.markdown).attr("placeholder",o.placeholder);if(typeof m.attr("name")==="undefined"||m.attr("name")===""){m.attr("name",(o.name!=="")?o.name:n+"-markdown-doc")}var p=[(!o.readOnly)?'<a href="javascript:;" class="fa fa-close '+s+'preview-close-btn"></a>':"",((o.saveHTMLToTextarea)?'<textarea class="'+l.textarea.html+'" name="'+n+'-html-code"></textarea>':""),'<div class="'+s+'preview"><div class="markdown-body '+s+'preview-container"></div></div>','<div class="'+s+'container-mask" style="display:block;"></div>','<div class="'+s+'mask"></div>'].join("\n");r.append(p).addClass(s+"vertical");if(o.theme!==""){r.addClass(s+"theme-"+o.theme)}this.mask=r.children("."+s+"mask");this.containerMask=r.children("."+s+"container-mask");if(o.markdown!==""){m.val(o.markdown)}if(o.appendMarkdown!==""){m.val(m.val()+o.appendMarkdown)}this.htmlTextarea=r.children("."+l.textarea.html);this.preview=r.children("."+s+"preview");this.previewContainer=this.preview.children("."+s+"preview-container");if(o.previewTheme!==""){this.preview.addClass(s+"preview-theme-"+o.previewTheme)}if(typeof g!=="undefined"){k.$CodeMirror=g}if(typeof a!=="undefined"){k.$marked=a}var q=this;q.setCodeMirror().setToolbar().loadedDisplay();return this},setTheme:function(o){var n=this.editor;var m=this.settings.theme;var l=this.classPrefix+"theme-";n.removeClass(l+m).addClass(l+o);this.settings.theme=o;return this},setEditorTheme:function(m){var l=this.settings;l.editorTheme=m;if(m!=="default"){k.loadCSS(l.path+"codemirror/theme/"+l.editorTheme)}this.cm.setOption("theme",m);return this},setCodeMirrorTheme:function(l){this.setEditorTheme(l);return this},setPreviewTheme:function(o){var n=this.preview;var m=this.settings.previewTheme;var l=this.classPrefix+"preview-theme-";n.removeClass(l+m).addClass(l+o);this.settings.previewTheme=o;return this},setCodeMirror:function(){var n=this.settings;var m=this.editor;if(n.editorTheme!=="default"){k.loadCSS(n.path+"codemirror/theme/"+n.editorTheme)}var l={mode:n.mode,theme:n.editorTheme,tabSize:n.tabSize,dragDrop:false,autofocus:n.autoFocus,autoCloseTags:n.autoCloseTags,readOnly:(n.readOnly)?"nocursor":false,indentUnit:n.indentUnit,lineNumbers:n.lineNumbers,lineWrapping:n.lineWrapping,extraKeys:{"Ctrl-Q":function(o){o.foldCode(o.getCursor())}},foldGutter:n.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:n.matchBrackets,indentWithTabs:n.indentWithTabs,styleActiveLine:n.styleActiveLine,styleSelectedText:n.styleSelectedText,autoCloseBrackets:n.autoCloseBrackets,showTrailingSpace:n.showTrailingSpace,highlightSelectionMatches:((!n.matchWordHighlight)?false:{showToken:(n.matchWordHighlight==="onselected")?false:/\w/})};this.codeEditor=this.cm=k.$CodeMirror.fromTextArea(this.markdownTextarea[0],l);this.codeMirror=this.cmElement=m.children(".CodeMirror");if(n.value!==""){this.cm.setValue(n.value)}this.codeMirror.css({fontSize:n.fontSize,width:(!n.watch)?"100%":"50%"});if(n.autoHeight){this.codeMirror.css("height","auto");this.cm.setOption("viewportMargin",Infinity)}if(!n.lineNumbers){this.codeMirror.find(".CodeMirror-gutters").css("border-right","none")}return this},getCodeMirrorOption:function(l){return this.cm.getOption(l)},setCodeMirrorOption:function(l,m){this.cm.setOption(l,m);return this},addKeyMap:function(m,l){this.cm.addKeyMap(m,l);return this},removeKeyMap:function(l){this.cm.removeKeyMap(l);return this},gotoLine:function(x){var o=this.settings;if(!o.gotoLine){return this}var v=this.cm;var r=this.editor;var q=v.lineCount();var t=this.preview;if(typeof x==="string"){if(x==="last"){x=q}if(x==="first"){x=1}}if(typeof x!=="number"){alert("Error: The line number must be an integer.");return this}x=parseInt(x)-1;if(x>q){alert("Error: The line number range 1-"+q);return this}v.setCursor({line:x,ch:0});var m=v.getScrollInfo();var p=m.clientHeight;var u=v.charCoords({line:x,ch:0},"local");v.scrollTo(null,(u.top+u.bottom-p)/2);if(o.watch){var n=this.codeMirror.find(".CodeMirror-scroll")[0];var w=h(n).height();var l=n.scrollTop;var s=(l/n.scrollHeight);if(l===0){t.scrollTop(0)}else{if(l+w>=n.scrollHeight-16){t.scrollTop(t[0].scrollHeight)}else{t.scrollTop(t[0].scrollHeight*s)}}}v.focus();return this},extend:function(){if(typeof arguments[1]!=="undefined"){if(typeof arguments[1]==="function"){arguments[1]=h.proxy(arguments[1],this)}this[arguments[0]]=arguments[1]}if(typeof arguments[0]==="object"&&typeof arguments[0].length==="undefined"){h.extend(true,this,arguments[0])}return this},set:function(l,m){if(typeof m!=="undefined"&&typeof m==="function"){m=h.proxy(m,this)}this[l]=m;return this},config:function(l,n){var m=this.settings;if(typeof l==="object"){m=h.extend(true,m,l)}if(typeof l==="string"){m[l]=n}this.settings=m;this.recreate();return this},on:function(l,n){var m=this.settings;if(typeof m["on"+l]!=="undefined"){m["on"+l]=h.proxy(n,this)}return this},off:function(l){var m=this.settings;if(typeof m["on"+l]!=="undefined"){m["on"+l]=function(){}}return this},showToolbar:function(m){var l=this.settings;if(l.readOnly){return this}if(l.toolbar&&(this.toolbar.length<1||this.toolbar.find("."+this.classPrefix+"menu").html()==="")){this.setToolbar()}l.toolbar=true;this.toolbar.show();this.resize();h.proxy(m||function(){},this)();return this},hideToolbar:function(m){var l=this.settings;l.toolbar=false;this.toolbar.hide();this.resize();h.proxy(m||function(){},this)();return this},setToolbarAutoFixed:function(p){var q=this.state;var n=this.editor;var o=this.toolbar;var m=this.settings;if(typeof p!=="undefined"){m.toolbarAutoFixed=p}var l=function(){var s=h(window);var r=s.scrollTop();if(!m.toolbarAutoFixed){return false}if(r-n.offset().top>10&&r<n.height()){o.css({position:"fixed",width:n.width()+"px",left:(s.width()-n.width())/2+"px"})}else{o.css({position:"absolute",width:"100%",left:0})}};if(!q.fullscreen&&!q.preview&&m.toolbar&&m.toolbarAutoFixed){h(window).bind("scroll",l)}return this},setToolbar:function(){var A=this.settings;if(A.readOnly){return this}var q=this.editor;var w=this.preview;var o=this.classPrefix;var t=this.toolbar=q.children("."+o+"toolbar");if(A.toolbar&&t.length<1){var v='<div class="'+o+'toolbar"><div class="'+o+'toolbar-container"><ul class="'+o+'menu"></ul></div></div>';q.append(v);t=this.toolbar=q.children("."+o+"toolbar")}if(!A.toolbar){t.hide();return this}t.show();var B=(typeof A.toolbarIcons==="function")?A.toolbarIcons():((typeof A.toolbarIcons==="string")?k.toolbarModes[A.toolbarIcons]:A.toolbarIcons);var n=t.find("."+this.classPrefix+"menu"),m="";var x=false;for(var y=0,z=B.length;y<z;y++){var D=B[y];if(D==="||"){x=true}else{if(D==="|"){m+='<li class="divider" unselectable="on">|</li>'}else{var r=(/h(\d)/.test(D));var s=D;if(D==="watch"&&!A.watch){s="unwatch"}var C=A.lang.toolbar[s];var u=A.toolbarIconTexts[s];var l=A.toolbarIconsClass[s];C=(typeof C==="undefined")?"":C;u=(typeof u==="undefined")?"":u;l=(typeof l==="undefined")?"":l;var p=x?'<li class="pull-right">':"<li>";if(typeof A.toolbarCustomIcons[D]!=="undefined"&&typeof A.toolbarCustomIcons[D]!=="function"){p+=A.toolbarCustomIcons[D]}else{p+='<a href="javascript:;" title="'+C+'" unselectable="on">';p+='<i class="fa '+l+'" name="'+D+'" unselectable="on">'+((r)?D.toUpperCase():((l==="")?u:""))+"</i>";p+="</a>"}p+="</li>";m=x?p+m:m+p}}}n.html(m);n.find('[title="Lowercase"]').attr("title",A.lang.toolbar.lowercase);n.find('[title="ucwords"]').attr("title",A.lang.toolbar.ucwords);this.setToolbarHandler();this.setToolbarAutoFixed();return this},dialogLockScreen:function(){h.proxy(k.dialogLockScreen,this)();return this},dialogShowMask:function(l){h.proxy(k.dialogShowMask,this)(l);return this},getToolbarHandles:function(l){var m=this.toolbarHandlers=k.toolbarHandlers;return(l&&typeof toolbarIconHandlers[l]!=="undefined")?m[l]:m},setToolbarHandler:function(){var r=this;var o=this.settings;if(!o.toolbar||o.readOnly){return this}var p=this.toolbar;var m=this.cm;var l=this.classPrefix;var q=this.toolbarIcons=p.find("."+l+"menu > li > a");var n=this.getToolbarHandles();q.bind(k.mouseOrTouch("click","touchend"),function(v){var u=h(this).children(".fa");var s=u.attr("name");var w=m.getCursor();var t=m.getSelection();if(s===""){return}r.activeIcon=u;if(typeof n[s]!=="undefined"){h.proxy(n[s],r)(m)}else{if(typeof o.toolbarHandlers[s]!=="undefined"){h.proxy(o.toolbarHandlers[s],r)(m,u,w,t)}}if(s!=="link"&&s!=="reference-link"&&s!=="image"&&s!=="code-block"&&s!=="preformatted-text"&&s!=="watch"&&s!=="preview"&&s!=="search"&&s!=="fullscreen"&&s!=="info"){m.focus()}return false});return this},createDialog:function(l){return h.proxy(k.createDialog,this)(l)},createInfoDialog:function(){var p=this;var n=this.editor;var l=this.classPrefix;var o=['<div class="'+l+"dialog "+l+'dialog-info" style="">','<div class="'+l+'dialog-container">','<h1><i class="editormd-logo editormd-logo-lg editormd-logo-color"></i> '+k.title+"<small>v"+k.version+"</small></h1>","<p>"+this.lang.description+"</p>",'<p style="margin: 10px 0 20px 0;"><a href="'+k.homePage+'" target="_blank">'+k.homePage+' <i class="fa fa-external-link"></i></a></p>','<p style="font-size: 0.85em;">Copyright &copy; 2015 <a href="https://github.com/pandao" target="_blank" class="hover-link">Pandao</a>, The <a href="https://github.com/pandao/editor.md/blob/master/LICENSE" target="_blank" class="hover-link">MIT</a> License.</p>',"</div>",'<a href="javascript:;" class="fa fa-close '+l+'dialog-close"></a>',"</div>"].join("\n");n.append(o);var m=this.infoDialog=n.children("."+l+"dialog-info");m.find("."+l+"dialog-close").bind(k.mouseOrTouch("click","touchend"),function(){p.hideInfoDialog()});m.css("border",(k.isIE8)?"1px solid #ddd":"").css("z-index",k.dialogZindex).show();this.infoDialogPosition();return this},infoDialogPosition:function(){var l=this.infoDialog;var m=function(){l.css({top:(h(window).height()-l.height())/2+"px",left:(h(window).width()-l.width())/2+"px"})};m();h(window).resize(m);return this},showInfoDialog:function(){h("html,body").css("overflow-x","hidden");var o=this;var n=this.editor;var m=this.settings;var l=this.infoDialog=n.children("."+this.classPrefix+"dialog-info");if(l.length<1){this.createInfoDialog()}this.lockScreen(true);this.mask.css({opacity:m.dialogMaskOpacity,backgroundColor:m.dialogMaskBgColor}).show();l.css("z-index",k.dialogZindex).show();this.infoDialogPosition();return this},hideInfoDialog:function(){h("html,body").css("overflow-x","");this.infoDialog.hide();this.mask.hide();this.lockScreen(false);return this},lockScreen:function(l){k.lockScreen(l);this.resize();return this},recreate:function(){var n=this;var m=this.editor;var l=this.settings;this.codeMirror.remove();this.setCodeMirror();if(!l.readOnly){if(m.find(".editormd-dialog").length>0){m.find(".editormd-dialog").remove()}if(l.toolbar){this.getToolbarHandles();this.setToolbar()}}this.loadedDisplay(true);return this},previewCodeHighlight:function(){var m=this.settings;var l=this.previewContainer;if(m.previewCodeHighlight){l.find("pre").addClass("prettyprint linenums");if(typeof prettyPrint!=="undefined"){prettyPrint()}}return this},katexRender:function(){if(b===null){return this}this.previewContainer.find("."+k.classNames.tex).each(function(){var l=h(this);k.$katex.render(l.text(),l[0]);l.find(".katex").css("font-size","1.6em")});return this},flowChartAndSequenceDiagramRender:function(){var t=this;var o=this.settings;var n=this.previewContainer;if(k.isIE8){return this}if(o.flowChart){if(d===null){return this}n.find(".flowchart").flowChart()}if(o.sequenceDiagram){n.find(".sequence-diagram").sequenceDiagram({theme:"simple"})}var s=t.preview;var q=t.codeMirror;var p=q.find(".CodeMirror-scroll");var v=p.height();var m=p.scrollTop();var r=(m/p[0].scrollHeight);var l=0;s.find(".markdown-toc-list").each(function(){l+=h(this).height()});var u=s.find(".editormd-toc-menu").height();u=(!u)?0:u;if(m===0){s.scrollTop(0)}else{if(m+v>=p[0].scrollHeight-16){s.scrollTop(s[0].scrollHeight)}else{s.scrollTop((s[0].scrollHeight+l+u)*r)}}return this},registerKeyMaps:function(u){var t=this;var v=this.cm;var o=this.settings;var r=k.toolbarHandlers;var w=o.disabledKeyMaps;u=u||null;if(u){for(var q in u){if(h.inArray(q,w)<0){var m={};m[q]=u[q];v.addKeyMap(u)}}}else{for(var p in k.keyMaps){var l=k.keyMaps[p];var s=(typeof l==="string")?h.proxy(r[l],t):h.proxy(l,t);if(h.inArray(p,["F9","F10","F11"])<0&&h.inArray(p,w)<0){var n={};n[p]=s;v.addKeyMap(n)}}h(window).keydown(function(y){var x={"120":"F9","121":"F10","122":"F11"};if(h.inArray(x[y.keyCode],w)<0){switch(y.keyCode){case 120:h.proxy(r["watch"],t)();return false;break;case 121:h.proxy(r["preview"],t)();return false;break;case 122:h.proxy(r["fullscreen"],t)();return false;break;default:break}}})}return this},bindScrollEvent:function(){var r=this;var s=this.preview;var n=this.settings;var q=this.codeMirror;var m=k.mouseOrTouch;if(!n.syncScrolling){return this}var l=function(){q.find(".CodeMirror-scroll").bind(m("scroll","touchmove"),function(y){var v=h(this).height();var z=h(this).scrollTop();var x=(z/h(this)[0].scrollHeight);var w=0;s.find(".markdown-toc-list").each(function(){w+=h(this).height()});var u=s.find(".editormd-toc-menu").height();u=(!u)?0:u;if(z===0){s.scrollTop(0)}else{if(z+v>=h(this)[0].scrollHeight-16){s.scrollTop(s[0].scrollHeight)}else{s.scrollTop((s[0].scrollHeight+w+u)*x)}}h.proxy(n.onscroll,r)(y)})};var o=function(){q.find(".CodeMirror-scroll").unbind(m("scroll","touchmove"))};var p=function(){s.bind(m("scroll","touchmove"),function(x){var u=h(this).height();var y=h(this).scrollTop();var w=(y/h(this)[0].scrollHeight);var v=q.find(".CodeMirror-scroll");if(y===0){v.scrollTop(0)}else{if(y+u>=h(this)[0].scrollHeight){v.scrollTop(v[0].scrollHeight)}else{v.scrollTop(v[0].scrollHeight*w)}}h.proxy(n.onpreviewscroll,r)(x)})};var t=function(){s.unbind(m("scroll","touchmove"))};q.bind({mouseover:l,mouseout:o,touchstart:l,touchend:o});if(n.syncScrolling==="single"){return this}s.bind({mouseover:p,mouseout:t,touchstart:p,touchend:t});return this},bindChangeEvent:function(){var n=this;var l=this.cm;var m=this.settings;if(!m.syncScrolling){return this}l.on("change",function(p,o){if(m.watch){n.previewContainer.css("padding",m.autoHeight?"20px 20px 50px 40px":"20px")}b=setTimeout(function(){clearTimeout(b);n.save();b=null},m.delay)});return this},loadedDisplay:function(l){l=l||false;var p=this;var n=this.editor;var o=this.preview;var m=this.settings;this.containerMask.hide();this.save();if(m.watch){o.show()}n.data("oldWidth",n.width()).data("oldHeight",n.height());this.resize();this.registerKeyMaps();h(window).resize(function(){p.resize()});this.bindScrollEvent().bindChangeEvent();if(!l){h.proxy(m.onload,this)()}this.state.loaded=true;return this},width:function(l){this.editor.css("width",(typeof l==="number")?l+"px":l);this.resize();return this},height:function(l){this.editor.css("height",(typeof l==="number")?l+"px":l);this.resize();return this},resize:function(m,t){m=m||null;t=t||null;var l=this.state;var q=this.editor;var r=this.preview;var s=this.toolbar;var n=this.settings;var o=this.codeMirror;if(m){q.css("width",(typeof m==="number")?m+"px":m)}if(n.autoHeight&&!l.fullscreen&&!l.preview){q.css("height","auto");o.css("height","auto")}else{if(t){q.css("height",(typeof t==="number")?t+"px":t)}if(l.fullscreen){q.height(h(window).height())}if(n.toolbar&&!n.readOnly){o.css("margin-top",s.height()+1).height(q.height()-s.height())}else{o.css("margin-top",0).height(q.height())}}if(n.watch){o.width(q.width()/2);r.width((!l.preview)?q.width()/2:q.width());this.previewContainer.css("padding",n.autoHeight?"20px 20px 50px 40px":"20px");if(n.toolbar&&!n.readOnly){r.css("top",s.height()+1)}else{r.css("top",0)}if(n.autoHeight&&!l.fullscreen&&!l.preview){r.height("")}else{var p=(n.toolbar&&!n.readOnly)?q.height()-s.height():q.height();r.height(p)}}else{o.width(q.width());r.hide()}if(l.loaded){h.proxy(n.onresize,this)()}return this},save:function(){if(b===null){return this}var s=this;var m=this.state;var p=this.settings;var v=this.cm;var u=v.getValue();var o=this.previewContainer;if(p.mode!=="gfm"&&p.mode!=="markdown"){this.markdownTextarea.val(u);return this}var l=k.$marked;var q=this.markdownToC=[];var w=this.markedRendererOptions={toc:p.toc,tocm:p.tocm,tocStartLevel:p.tocStartLevel,pageBreak:p.pageBreak,taskList:p.taskList,emoji:p.emoji,tex:p.tex,atLink:p.atLink,emailLink:p.emailLink,flowChart:p.flowChart,sequenceDiagram:p.sequenceDiagram,previewCodeHighlight:p.previewCodeHighlight,};var t=this.markedOptions={renderer:k.markedRenderer(q,w),gfm:true,tables:true,breaks:true,pedantic:false,sanitize:(p.htmlDecode)?false:true,smartLists:true,smartypants:true};l.setOptions(t);var n=k.$marked(u,t);n=k.filterHTMLTags(n,p.htmlDecode);this.markdownTextarea.text(u);v.save();if(p.saveHTMLToTextarea){this.htmlTextarea.text(n)}if(p.watch||(!p.watch&&m.preview)){o.html(n);this.previewCodeHighlight();if(p.toc){var r=(p.tocContainer==="")?o:h(p.tocContainer);var x=r.find("."+this.classPrefix+"toc-menu");r.attr("previewContainer",(p.tocContainer==="")?"true":"false");if(p.tocContainer!==""&&x.length>0){x.remove()}k.markdownToCRenderer(q,r,p.tocDropdown,p.tocStartLevel);if(p.tocDropdown||r.find("."+this.classPrefix+"toc-menu").length>0){k.tocDropdownMenu(r,(p.tocTitle!=="")?p.tocTitle:this.lang.tocTitle)}if(p.tocContainer!==""){o.find(".markdown-toc").css("border","none")}}if(p.tex){if(!k.kaTeXLoaded&&p.autoLoadModules){k.loadKaTeX(function(){k.$katex=katex;k.kaTeXLoaded=true;s.katexRender()})}else{k.$katex=katex;this.katexRender()}}if(p.flowChart||p.sequenceDiagram){d=setTimeout(function(){clearTimeout(d);s.flowChartAndSequenceDiagramRender();d=null},10)}if(m.loaded){h.proxy(p.onchange,this)()}}return this},focus:function(){this.cm.focus();return this},setCursor:function(l){this.cm.setCursor(l);return this},getCursor:function(){return this.cm.getCursor()},setSelection:function(m,l){this.cm.setSelection(m,l);return this},getSelection:function(){return this.cm.getSelection()},setSelections:function(l){this.cm.setSelections(l);return this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(l){this.cm.replaceSelection(l);return this},insertValue:function(l){this.replaceSelection(l);return this},appendMarkdown:function(n){var m=this.settings;var l=this.cm;l.setValue(l.getValue()+n);return this},setMarkdown:function(l){this.cm.setValue(l||this.settings.markdown);return this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(l){this.cm.setValue(l);return this},clear:function(){this.cm.setValue("");return this},getHTML:function(){if(!this.settings.saveHTMLToTextarea){alert("Error: settings.saveHTMLToTextarea == false");return false}return this.htmlTextarea.val()},getTextareaSavedHTML:function(){return this.getHTML()},getPreviewedHTML:function(){if(!this.settings.watch){alert("Error: settings.watch == false");return false}return this.previewContainer.html()},watch:function(p){var n=this.settings;if(h.inArray(n.mode,["gfm","markdown"])<0){return this}this.state.watching=n.watch=true;this.preview.show();if(this.toolbar){var l=n.toolbarIconsClass.watch;var o=n.toolbarIconsClass.unwatch;var m=this.toolbar.find(".fa[name=watch]");m.parent().attr("title",n.lang.toolbar.watch);m.removeClass(o).addClass(l)}this.codeMirror.css("border-right","1px solid #ddd").width(this.editor.width()/2);b=0;this.save().resize();if(!n.onwatch){n.onwatch=p||function(){}}h.proxy(n.onwatch,this)();return this},unwatch:function(p){var n=this.settings;this.state.watching=n.watch=false;this.preview.hide();if(this.toolbar){var l=n.toolbarIconsClass.watch;var o=n.toolbarIconsClass.unwatch;var m=this.toolbar.find(".fa[name=watch]");m.parent().attr("title",n.lang.toolbar.unwatch);m.removeClass(l).addClass(o)}this.codeMirror.css("border-right","none").width(this.editor.width());this.resize();if(!n.onunwatch){n.onunwatch=p||function(){}}h.proxy(n.onunwatch,this)();return this},show:function(m){m=m||function(){};var l=this;this.editor.show(0,function(){h.proxy(m,l)()});return this},hide:function(m){m=m||function(){};var l=this;this.editor.hide(0,function(){h.proxy(m,l)()});return this},previewing:function(){var s=this;var n=this.editor;var r=this.preview;var p=this.toolbar;var m=this.settings;var o=this.codeMirror;var l=this.previewContainer;if(h.inArray(m.mode,["gfm","markdown"])<0){return this}if(m.toolbar&&p){p.toggle();p.find(".fa[name=preview]").toggleClass("active")}o.toggle();var q=function(t){if(t.shiftKey&&t.keyCode===27){s.previewed()}};if(o.css("display")==="none"){this.state.preview=true;if(this.state.fullscreen){r.css("background","#fff")}n.find("."+this.classPrefix+"preview-close-btn").show().bind(k.mouseOrTouch("click","touchend"),function(){s.previewed()});if(!m.watch){this.save()}else{l.css("padding","")}l.addClass(this.classPrefix+"preview-active");r.show().css({position:"",top:0,width:n.width(),height:(m.autoHeight&&!this.state.fullscreen)?"auto":n.height()});if(this.state.loaded){h.proxy(m.onpreviewing,this)()}h(window).bind("keyup",q)}else{h(window).unbind("keyup",q);this.previewed()}},previewed:function(){var o=this.editor;var q=this.preview;var p=this.toolbar;var n=this.settings;var m=this.previewContainer;var l=o.find("."+this.classPrefix+"preview-close-btn");this.state.preview=false;this.codeMirror.show();if(n.toolbar){p.show()}q[(n.watch)?"show":"hide"]();l.hide().unbind(k.mouseOrTouch("click","touchend"));m.removeClass(this.classPrefix+"preview-active");if(n.watch){m.css("padding","20px")}q.css({background:null,position:"absolute",width:o.width()/2,height:(n.autoHeight&&!this.state.fullscreen)?"auto":o.height()-p.height(),top:(n.toolbar)?p.height():0});if(this.state.loaded){h.proxy(n.onpreviewed,this)()}return this},fullscreen:function(){var s=this;var p=this.state;var n=this.editor;var r=this.preview;var o=this.toolbar;var m=this.settings;var l=this.classPrefix+"fullscreen";if(o){o.find(".fa[name=fullscreen]").parent().toggleClass("active")}var q=function(t){if(!t.shiftKey&&t.keyCode===27){if(p.fullscreen){s.fullscreenExit()}}};if(!n.hasClass(l)){p.fullscreen=true;h("html,body").css("overflow","hidden");n.css({width:h(window).width(),height:h(window).height()}).addClass(l);this.resize();h.proxy(m.onfullscreen,this)();h(window).bind("keyup",q)}else{h(window).unbind("keyup",q);this.fullscreenExit()}return this},fullscreenExit:function(){var n=this.editor;var m=this.settings;var o=this.toolbar;var l=this.classPrefix+"fullscreen";this.state.fullscreen=false;if(o){o.find(".fa[name=fullscreen]").parent().removeClass("active")}h("html,body").css("overflow","");n.css({width:n.data("oldWidth"),height:n.data("oldHeight")}).removeClass(l);this.resize();h.proxy(m.onfullscreenExit,this)();return this},executePlugin:function(m,o){var p=this;var l=this.cm;var n=this.settings;o=n.pluginPath+o;if(typeof define==="function"){if(typeof this[m]==="undefined"){alert("Error: "+m+" plugin is not found, you are not load this plugin.");return this}this[m](l);return this}if(h.inArray(o,k.loadFiles.plugin)<0){k.loadPlugin(o,function(){k.loadPlugins[m]=p[m];p[m](l)})}else{h.proxy(k.loadPlugins[m],this)(l)}return this},search:function(m){var l=this.settings;if(!l.searchReplace){alert("Error: settings.searchReplace == false");return this}if(!l.readOnly){this.cm.execCommand(m||"find")}return this},searchReplace:function(){this.search("replace");return this},searchReplaceAll:function(){this.search("replaceAll");return this}};k.fn.init.prototype=k.fn;k.dialogLockScreen=function(){var l=this.settings||{dialogLockScreen:true};if(l.dialogLockScreen){h("html,body").css("overflow","hidden");this.resize()}};k.dialogShowMask=function(l){var n=this.editor;var m=this.settings||{dialogShowMask:true};l.css({top:(h(window).height()-l.height())/2+"px",left:(h(window).width()-l.width())/2+"px"});if(m.dialogShowMask){n.children("."+this.classPrefix+"mask").css("z-index",parseInt(l.css("z-index"))-1).show()}};k.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();l.replaceSelection("**"+m+"**");if(m===""){l.setCursor(n.line,n.ch+2)}},del:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();l.replaceSelection("~~"+m+"~~");if(m===""){l.setCursor(n.line,n.ch+2)}},italic:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();l.replaceSelection("*"+m+"*");if(m===""){l.setCursor(n.line,n.ch+1)}},quote:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(n.ch!==0){l.setCursor(n.line,0);l.replaceSelection("> "+m);l.setCursor(n.line,n.ch+2)}else{l.replaceSelection("> "+m)}},ucfirst:function(){var l=this.cm;var n=l.getSelection();var m=l.listSelections();l.replaceSelection(k.firstUpperCase(n));l.setSelections(m)},ucwords:function(){var l=this.cm;var n=l.getSelection();var m=l.listSelections();l.replaceSelection(k.wordsFirstUpperCase(n));l.setSelections(m)},uppercase:function(){var l=this.cm;var n=l.getSelection();var m=l.listSelections();l.replaceSelection(n.toUpperCase());l.setSelections(m)},lowercase:function(){var l=this.cm;var o=l.getCursor();var n=l.getSelection();var m=l.listSelections();l.replaceSelection(n.toLowerCase());l.setSelections(m)},h1:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(n.ch!==0){l.setCursor(n.line,0);l.replaceSelection("# "+m);l.setCursor(n.line,n.ch+2)}else{l.replaceSelection("# "+m)}},h2:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(n.ch!==0){l.setCursor(n.line,0);l.replaceSelection("## "+m);l.setCursor(n.line,n.ch+3)}else{l.replaceSelection("## "+m)}},h3:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(n.ch!==0){l.setCursor(n.line,0);l.replaceSelection("### "+m);l.setCursor(n.line,n.ch+4)}else{l.replaceSelection("### "+m)}},h4:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(n.ch!==0){l.setCursor(n.line,0);l.replaceSelection("#### "+m);l.setCursor(n.line,n.ch+5)}else{l.replaceSelection("#### "+m)}},h5:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(n.ch!==0){l.setCursor(n.line,0);l.replaceSelection("##### "+m);l.setCursor(n.line,n.ch+6)}else{l.replaceSelection("##### "+m)}},h6:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(n.ch!==0){l.setCursor(n.line,0);l.replaceSelection("###### "+m);l.setCursor(n.line,n.ch+7)}else{l.replaceSelection("###### "+m)}},"list-ul":function(){var m=this.cm;var q=m.getCursor();var o=m.getSelection();if(o===""){m.replaceSelection("- "+o)}else{var p=o.split("\n");for(var n=0,l=p.length;n<l;n++){p[n]=(p[n]==="")?"":"- "+p[n]}m.replaceSelection(p.join("\n"))}},"list-ol":function(){var m=this.cm;var q=m.getCursor();var o=m.getSelection();if(o===""){m.replaceSelection("1. "+o)}else{var p=o.split("\n");for(var n=0,l=p.length;n<l;n++){p[n]=(p[n]==="")?"":(n+1)+". "+p[n]}m.replaceSelection(p.join("\n"))}},hr:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();l.replaceSelection(((n.ch!==0)?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex){alert("settings.tex === false");return this}var l=this.cm;var n=l.getCursor();var m=l.getSelection();l.replaceSelection("$$"+m+"$$");if(m===""){l.setCursor(n.line,n.ch+2)}},link:function(){},"reference-link":function(){this.executePlugin("referenceLinkDialog","reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak){alert("settings.pageBreak === false");return this}var l=this.cm;var m=l.getSelection();l.replaceSelection("\r\n[========]\r\n")},image:function(){this.executePlugin("imageDialog","image-dialog/image-dialog")},code:function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();l.replaceSelection("`"+m+"`");if(m===""){l.setCursor(n.line,n.ch+1)}},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var l=this.cm;var n=l.getSelection();var m=new Date();var o=this.settings.lang.name;var p=k.dateFormat()+" "+k.dateFormat((o==="zh-cn"||o==="zh-tw")?"cn-week-day":"week-day");l.replaceSelection(p)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog","html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},info:function(){this.showInfoDialog()}};k.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(!this.settings.emoji){alert("Error: settings.emoji == false");return}l.replaceSelection(":"+m+":");if(m===""){l.setCursor(n.line,n.ch+1)}},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var l=this.cm;var o=l.getCursor();var m=l.getSelection();var n=(m==="")?"":' "'+m+'"';l.replaceSelection("["+m+"]("+n+")");if(m===""){l.setCursor(o.line,o.ch+1)}},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();if(!this.settings.atLink){alert("Error: settings.atLink == false");return}l.replaceSelection("@"+m);if(m===""){l.setCursor(n.line,n.ch+1)}},"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var l=this.cm;var n=l.getCursor();var m=l.getSelection();l.replaceSelection(["```",m,"```"].join("\n"));if(m===""){l.setCursor(n.line,n.ch+3)}},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var l=this.cm;var o=l.getCursor();var m=l.getSelection();var n=(m==="")?"":' "'+m+'"';l.replaceSelection("!["+m+"]("+n+")");if(m===""){l.setCursor(o.line,o.ch+4)}},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol","Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak","F9":"watch","F10":"preview","F11":"fullscreen",};var f=function(l){return(!String.prototype.trim)?l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):l.trim()};k.trim=f;var i=function(l){return l.toLowerCase().replace(/\b(\w)|\s(\w)/g,function(m){return m.toUpperCase()})};k.ucwords=k.wordsFirstUpperCase=i;var c=function(l){return l.toLowerCase().replace(/\b(\w)/,function(m){return m.toUpperCase()})};var e=c;k.firstUpperCase=k.ucfirst=c;k.urls={atLinkBase:"https://github.com/"};k.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\.\_]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/};k.emoji={path:"http://www.emoji-cheat-sheet.com/graphics/emojis/",ext:".png"};k.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"};k.markedRenderer=function(r,z){var p={toc:true,tocm:false,tocStartLevel:1,pageBreak:true,atLink:true,emailLink:true,taskList:false,emoji:false,tex:false,flowChart:false,sequenceDiagram:false,};var o=h.extend(p,z||{});var n=k.$marked;var u=new n.Renderer();r=r||[];var s=k.regexs;var q=s.atLink;var v=s.emoji;var x=s.email;var m=s.emailLink;var y=s.twemoji;var t=s.fontAwesome;var l=s.editormdLogo;var w=s.pageBreak;u.emoji=function(C){C=C.replace(k.regexs.emojiDatetime,function(E){return E.replace(/:/g,"&#58;")});var D=C.match(v);if(!D||!o.emoji){return C}for(var B=0,A=D.length;B<A;B++){if(D[B]===":+1:"){D[B]=":\\+1:"}C=C.replace(new RegExp(D[B]),function(O,K){var R=O.match(t);var G=O.replace(/:/g,"");if(R){for(var M=0,P=R.length;M<P;M++){var L=R[M].replace(/:/g,"");return'<i class="fa '+L+' fa-emoji" title="'+L.replace("fa-","")+'"></i>'}}else{var I=O.match(l);var H=O.match(y);if(I){for(var S=0,N=I.length;S<N;S++){var F=I[S].replace(/:/g,"");return'<i class="'+F+'" title="Editor.md logo ('+F+')"></i>'}}else{if(H){for(var T=0,J=H.length;T<J;T++){var Q=H[T].replace(/:/g,"").replace("tw-","");return'<img src="'+k.twemoji.path+Q+k.twemoji.ext+'" title="twemoji-'+Q+'" alt="twemoji-'+Q+'" class="emoji twemoji" />'}}else{var E=(G==="+1")?"plus1":G;E=(E==="black_large_square")?"black_square":E;E=(E==="moon")?"waxing_gibbous_moon":E;return'<img src="'+k.emoji.path+E+k.emoji.ext+'" class="emoji" title="&#58;'+G+'&#58;" alt="&#58;'+G+'&#58;" />'}}}})}return C};u.atLink=function(A){if(q.test(A)){if(o.atLink){A=A.replace(x,function(B,E,D,C){return B.replace(/@/g,"_#_&#64;_#_")});A=A.replace(q,function(B,C){return'<a href="'+k.urls.atLinkBase+""+C+'" title="&#64;'+C+'" class="at-link">'+B+"</a>"}).replace(/_#_&#64;_#_/g,"@")}if(o.emailLink){A=A.replace(m,function(B,F,E,D,C){return(!F&&h.inArray(C,"jpg|jpeg|png|gif|webp|ico|icon|pdf".split("|"))<0)?'<a href="mailto:'+B+'">'+B+"</a>":B})}return A}return A};u.link=function(A,F,E){if(this.options.sanitize){try{var C=decodeURIComponent(unescape(A)).replace(/[^\w:]/g,"").toLowerCase()}catch(D){return""}if(C.indexOf("javascript:")===0){return""}}var B='<a href="'+A+'"';if(q.test(F)||q.test(E)){if(F){B+=' title="'+F.replace(/@/g,"&#64;")}return B+'">'+E.replace(/@/g,"&#64;")+"</a>"}if(F){B+=' title="'+F+'"'}B+=">"+E+"</a>";return B};u.heading=function(M,A,L){var C=M;var E=/\s*\<a\s*href\=\"(.*)\"\s*([^\>]*)\>(.*)\<\/a\>\s*/;var G=/\s*\<a\s*([^\>]+)\>([^\>]*)\<\/a\>\s*/g;if(E.test(M)){var N=[];M=M.split(/\<a\s*([^\>]+)\>([^\>]*)\<\/a\>/);for(var F=0,I=M.length;F<I;F++){N.push(M[F].replace(/\s*href\=\"(.*)\"\s*/g,""))}M=N.join(" ")}M=f(M);var J=M.toLowerCase().replace(/[^\w]+/g,"-");var D={text:M,level:A,slug:J};var K=/^[\u4e00-\u9fa5]+$/.test(M);var B=(K)?escape(M).replace(/\%/g,""):M.toLowerCase().replace(/[^\w]+/g,"-");r.push(D);var H="<h"+A+' id="h'+A+"-"+this.options.headerPrefix+B+'">';H+='<a name="'+M+'" class="reference-link"></a>';H+='<span class="header-link octicon octicon-link"></span>';H+=(E)?this.atLink(this.emoji(C)):this.atLink(this.emoji(M));H+="</h"+A+">";return H};u.pageBreak=function(A){if(w.test(A)&&o.pageBreak){A='<hr style="page-break-after:always;" class="page-break editormd-page-break" />'}return A};u.paragraph=function(G){var F=/\$\$(.*)\$\$/g.test(G);var A=/^\$\$(.*)\$\$$/.test(G);var D=(A)?' class="'+k.classNames.tex+'"':"";var C=(o.tocm)?/^(\[TOC\]|\[TOCM\])$/.test(G):/^\[TOC\]$/.test(G);var B=/^\[TOCM\]$/.test(G);if(!A&&F){G=G.replace(/(\$\$([^\$]*)\$\$)+/g,function(H,I){return'<span class="'+k.classNames.tex+'">'+I.replace(/\$/g,"")+"</span>"})}else{G=(A)?G.replace(/\$/g,""):G}var E='<div class="markdown-toc editormd-markdown-toc">'+G+"</div>";return(C)?((B)?'<div class="editormd-toc-menu">'+E+"</div><br/>":E):((w.test(G))?this.pageBreak(G):"<p"+D+">"+this.atLink(this.emoji(G))+"</p>\n")};u.code=function(A,C,B){if(C==="seq"||C==="sequence"){return'<div class="sequence-diagram">'+A+"</div>"}else{if(C==="flow"){return'<div class="flowchart">'+A+"</div>"}else{if(C==="math"||C==="latex"||C==="katex"){return'<p class="'+k.classNames.tex+'">'+A+"</p>"}else{return n.Renderer.prototype.code.apply(this,arguments)}}}};u.tablecell=function(D,B){var C=(B.header)?"th":"td";var A=(B.align)?"<"+C+' style="text-align:'+B.align+'">':"<"+C+">";return A+this.atLink(this.emoji(D))+"</"+C+">\n"};u.listitem=function(A){if(o.taskList&&/^\s*\[[x\s]\]\s*/.test(A)){A=A.replace(/^\s*\[\s\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" /> ').replace(/^\s*\[x\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" checked disabled /> ');return'<li style="list-style: none;">'+this.atLink(this.emoji(A))+"</li>"}else{return"<li>"+this.atLink(this.emoji(A))+"</li>"}};return u};k.markdownToCRenderer=function(o,n,x,p){var r="";var l=0;var v=this.classPrefix;p=p||1;for(var q=0,t=o.length;q<t;q++){var w=o[q].text;var m=o[q].level;if(m<p){continue}if(m>l){r+=""}else{if(m<l){r+=(new Array(l-m+2)).join("</ul></li>")}else{r+="</ul></li>"}}r+='<li><a class="toc-level-'+m+'" href="#'+w+'" level="'+m+'">'+w+"</a><ul>";l=m}var s=n.find(".markdown-toc");if((s.length<1&&n.attr("previewContainer")==="false")){var u='<div class="markdown-toc '+v+'markdown-toc"></div>';u=(x)?'<div class="'+v+'toc-menu">'+u+"</div>":u;n.html(u);s=n.find(".markdown-toc")}if(x){s.wrap('<div class="'+v+'toc-menu"></div><br/>')}s.html('<ul class="markdown-toc-list"></ul>').children(".markdown-toc-list").html(r.replace(/\r?\n?\<ul\>\<\/ul\>/g,""));return s};k.tocDropdownMenu=function(m,l){l=l||"Table of Contents";var n=400;var o=m.find("."+this.classPrefix+"toc-menu");o.each(function(){var s=h(this);var u=s.children(".markdown-toc");var q='<i class="fa fa-angle-down"></i>';var p='<a href="javascript:;" class="toc-menu-btn">'+q+l+"</a>";var t=u.children("ul");var r=t.find("li");u.append(p);r.first().before("<li><h1>"+l+" "+q+"</h1></li>");s.mouseover(function(){t.show();r.each(function(){var v=h(this);var x=v.children("ul");if(x.html()===""){x.remove()}if(x.length>0&&x.html()!==""){var w=v.children("a").first();if(w.children(".fa").length<1){w.append(h(q).css({"float":"right","padding-top":"4px"}))}}v.mouseover(function(){x.css("z-index",n).show();n+=1}).mouseleave(function(){x.hide()})})}).mouseleave(function(){t.hide()})});return o};k.filterHTMLTags=function(o,l){if(typeof o!=="string"){o=new String(o)}if(typeof l!=="string"){return o}var q=l.split("|");var m=q[0].split(",");var s=q[1];for(var n=0,p=m.length;n<p;n++){var t=m[n];o=o.replace(new RegExp("<s*"+t+"s*([^>]*)>([^>]*)<s*/"+t+"s*>","igm"),"")}if(typeof s!=="undefined"){var r=/\<(\w+)\s*([^\>]*)\>([^\>]*)\<\/(\w+)\>/ig;if(s==="*"){o=o.replace(r,function(u,y,x,w,v){return"<"+y+">"+w+"</"+v+">"})}else{if(s==="on*"){o=o.replace(r,function(A,z,y,x,v){var w=h("<"+z+">"+x+"</"+v+">");var u=h(A)[0].attributes;var B={};h.each(u,function(D,E){if(E.nodeName!=='"'){B[E.nodeName]=E.nodeValue}});h.each(B,function(D){if(D.indexOf("on")===0){delete B[D]}});w.attr(B);var C=(typeof w[1]!=="undefined")?h(w[1]).text():"";return w[0].outerHTML+C})}else{o=o.replace(r,function(u,z,y,x){var w=s.split(",");var v=h(u);v.html(x);h.each(w,function(A){v.attr(w[A],null)});return v[0].outerHTML})}}}return o};k.markdownToHTML=function(m,x){var o={gfm:true,toc:true,tocm:false,tocStartLevel:1,tocTitle:"目录",tocDropdown:false,tocContainer:"",markdown:"",markdownSourceCode:false,htmlDecode:false,autoLoadKaTeX:true,pageBreak:true,atLink:true,emailLink:true,tex:false,taskList:false,emoji:false,flowChart:false,sequenceDiagram:false,previewCodeHighlight:true};k.$marked=a;var l=h("#"+m);var n=l.settings=h.extend(true,o,x||{});var w=l.find("textarea");if(w.length<1){l.append("<textarea></textarea>");w=l.find("textarea")}var q=(n.markdown==="")?w.val():n.markdown;var p=[];var v={toc:n.toc,tocm:n.tocm,tocStartLevel:n.tocStartLevel,taskList:n.taskList,emoji:n.emoji,tex:n.tex,pageBreak:n.pageBreak,atLink:n.atLink,emailLink:n.emailLink,flowChart:n.flowChart,sequenceDiagram:n.sequenceDiagram,previewCodeHighlight:n.previewCodeHighlight,};var u={renderer:k.markedRenderer(p,v),gfm:n.gfm,tables:true,breaks:true,pedantic:false,sanitize:(n.htmlDecode)?false:true,smartLists:true,smartypants:true};q=new String(q);var s=a(q,u);s=k.filterHTMLTags(s,n.htmlDecode);if(n.markdownSourceCode){w.text(q)}else{w.remove()}l.addClass("markdown-body "+this.classPrefix+"html-preview").append(s);var r=(n.tocContainer!=="")?h(n.tocContainer):l;if(n.tocContainer!==""){r.attr("previewContainer",false)}if(n.toc){l.tocContainer=this.markdownToCRenderer(p,r,n.tocDropdown,n.tocStartLevel);if(n.tocDropdown||l.find("."+this.classPrefix+"toc-menu").length>0){this.tocDropdownMenu(l,n.tocTitle)}if(n.tocContainer!==""){l.find(".editormd-toc-menu, .editormd-markdown-toc").remove()}}if(n.previewCodeHighlight){l.find("pre").addClass("prettyprint linenums");prettyPrint()}if(!k.isIE8){if(n.flowChart){l.find(".flowchart").flowChart()}if(n.sequenceDiagram){l.find(".sequence-diagram").sequenceDiagram({theme:"simple"})}}if(n.tex){var t=function(){l.find("."+k.classNames.tex).each(function(){var y=h(this);katex.render(y.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"),y[0]);y.find(".katex").css("font-size","1.6em")})};if(n.autoLoadKaTeX&&!k.$katex&&!k.kaTeXLoaded){this.loadKaTeX(function(){k.$katex=katex;k.kaTeXLoaded=true;t()})}else{t()}}l.getMarkdown=function(){return w.val()};return l};k.themes=["default","dark"];k.previewThemes=["default","dark"];k.editorThemes=["default","3024-day","3024-night","ambiance","ambiance-mobile","base16-dark","base16-light","blackboard","cobalt","eclipse","elegant","erlang-dark","lesser-dark","mbo","mdn-like","midnight","monokai","neat","neo","night","paraiso-dark","paraiso-light","pastel-on-dark","rubyblue","solarized","the-matrix","tomorrow-night-eighties","twilight","vibrant-ink","xq-dark","xq-light"];k.loadPlugins={};k.loadFiles={js:[],css:[],plugin:[]};k.loadPlugin=function(n,m,l){m=m||function(){};this.loadScript(n,function(){k.loadFiles.plugin.push(n);m()},l)};k.loadCSS=function(o,n,l){l=l||"head";n=n||function(){};var m=document.createElement("link");m.type="text/css";m.rel="stylesheet";m.onload=m.onreadystatechange=function(){k.loadFiles.css.push(o);n()};m.href=o+".css";if(l==="head"){document.getElementsByTagName("head")[0].appendChild(m)}else{document.body.appendChild(m)}};k.isIE=(navigator.appName=="Microsoft Internet Explorer");k.isIE8=(k.isIE&&navigator.appVersion.match(/8./i)=="8.");k.loadScript=function(o,n,m){m=m||"head";n=n||function(){};var l=null;l=document.createElement("script");l.id=o.replace(/[\./]+/g,"-");l.type="text/javascript";l.src=o+".js";if(k.isIE8){l.onreadystatechange=function(){if(l.readyState){if(l.readyState==="loaded"||l.readyState==="complete"){l.onreadystatechange=null;k.loadFiles.js.push(o);n()}}}}else{l.onload=function(){k.loadFiles.js.push(o);n()}}if(m==="head"){document.getElementsByTagName("head")[0].appendChild(l)}else{document.body.appendChild(l)}};k.katexURL={css:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min",js:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min"};k.kaTeXLoaded=false;k.loadKaTeX=function(l){k.loadCSS(k.katexURL.css,function(){k.loadScript(k.katexURL.js,l||function(){})})};k.lockScreen=function(l){h("html,body").css("overflow",(l)?"hidden":"")};k.createDialog=function(m){var v={name:"",width:420,height:240,title:"",drag:true,closed:true,content:"",mask:true,maskStyle:{backgroundColor:"#fff",opacity:0.1},lockScreen:true,footer:true,buttons:false};m=h.extend(true,v,m);var r=this;var n=this.editor;var l=k.classPrefix;var B=(new Date()).getTime();var p=((m.name==="")?l+"dialog-"+B:m.name);var z=k.mouseOrTouch;var w='<div class="'+l+"dialog "+p+'">';if(m.title!==""){w+='<div class="'+l+'dialog-header"'+((m.drag)?' style="cursor: move;"':"")+">";w+='<strong class="'+l+'dialog-title">'+m.title+"</strong>";w+="</div>"}if(m.closed){w+='<a href="javascript:;" class="fa fa-close '+l+'dialog-close"></a>'}w+='<div class="'+l+'dialog-container">'+m.content;if(m.footer||typeof m.footer==="string"){w+='<div class="'+l+'dialog-footer">'+((typeof m.footer==="boolean")?"":m.footer)+"</div>"}w+="</div>";w+='<div class="'+l+"dialog-mask "+l+'dialog-mask-bg"></div>';w+='<div class="'+l+"dialog-mask "+l+'dialog-mask-con"></div>';w+="</div>";n.append(w);var E=n.find("."+p);E.lockScreen=function(G){if(m.lockScreen){h("html,body").css("overflow",(G)?"hidden":"");r.resize()}return E};E.showMask=function(){if(m.mask){n.find("."+l+"mask").css(m.maskStyle).css("z-index",k.dialogZindex-1).show()}return E};E.hideMask=function(){if(m.mask){n.find("."+l+"mask").hide()}return E};E.loading=function(G){var H=E.find("."+l+"dialog-mask");H[(G)?"show":"hide"]();return E};E.lockScreen(true).showMask();E.show().css({zIndex:k.dialogZindex,border:(k.isIE8)?"1px solid #ddd":"",width:(typeof m.width==="number")?m.width+"px":m.width,height:(typeof m.height==="number")?m.height+"px":m.height});var D=function(){E.css({top:(h(window).height()-E.height())/2+"px",left:(h(window).width()-E.width())/2+"px"})};D();h(window).resize(D);E.children("."+l+"dialog-close").bind(z("click","touchend"),function(){E.hide().lockScreen(false).hideMask()});if(typeof m.buttons==="object"){var A=E.footer=E.find("."+l+"dialog-footer");for(var F in m.buttons){var t=m.buttons[F];var q=l+F+"-btn";A.append('<button class="'+l+"btn "+q+'">'+t[0]+"</button>");t[1]=h.proxy(t[1],E);A.children("."+q).bind(z("click","touchend"),t[1])}}if(m.title!==""&&m.drag){var u,s;var x=E.children("."+l+"dialog-header");if(!m.mask){x.bind(z("click","touchend"),function(){k.dialogZindex+=2;E.css("z-index",k.dialogZindex)})}x.mousedown(function(G){G=G||window.event;u=G.clientX-parseInt(E[0].style.left);s=G.clientY-parseInt(E[0].style.top);document.onmousemove=y});var o=function(G){G.removeClass(l+"user-unselect").off("selectstart")};var C=function(G){G.addClass(l+"user-unselect").on("selectstart",function(H){return false})};var y=function(K){K=K||window.event;var J,I,H=parseInt(E[0].style.left),G=parseInt(E[0].style.top);if(H>=0){if(H+E.width()<=h(window).width()){J=K.clientX-u}else{J=h(window).width()-E.width();document.onmousemove=null}}else{J=0;document.onmousemove=null}if(G>=0){I=K.clientY-s}else{I=0;document.onmousemove=null}document.onselectstart=function(){return false};C(h("body"));C(E);E[0].style.left=J+"px";E[0].style.top=I+"px"};document.onmouseup=function(){o(h("body"));o(E);document.onselectstart=null;document.onmousemove=null};x.touchDraggable=function(){var H=null;var I=function(J){var L=J.originalEvent;var K=h(this).parent().position();H={x:L.changedTouches[0].pageX-K.left,y:L.changedTouches[0].pageY-K.top}};var G=function(J){J.preventDefault();var K=J.originalEvent;h(this).parent().css({top:K.changedTouches[0].pageY-H.y,left:K.changedTouches[0].pageX-H.x})};this.bind("touchstart",I).bind("touchmove",G)};x.touchDraggable()}k.dialogZindex+=2;return E};k.mouseOrTouch=function(m,o){m=m||"click";o=o||"touchend";var l=m;try{document.createEvent("TouchEvent");l=o}catch(n){}return l};k.dateFormat=function(y){y=y||"";var r=function(D){return(D<10)?"0"+D:D};var z=new Date();var s=z.getFullYear();var m=s.toString().slice(2,4);var A=r(z.getMonth()+1);var x=r(z.getDate());var t=z.getDay();var p=r(z.getHours());var w=r(z.getMinutes());var B=r(z.getSeconds());var v=r(z.getMilliseconds());var u="";var C=m+"-"+A+"-"+x;var l=s+"-"+A+"-"+x;var n=p+":"+w+":"+B;switch(y){case"UNIX Time":u=z.getTime();break;case"UTC":u=z.toUTCString();break;case"yy":u=m;break;case"year":case"yyyy":u=s;break;case"month":case"mm":u=A;break;case"cn-week-day":case"cn-wd":var o=["日","一","二","三","四","五","六"];u="星期"+o[t];break;case"week-day":case"wd":var q=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];u=q[t];break;case"day":case"dd":u=x;break;case"hour":case"hh":u=p;break;case"min":case"ii":u=w;break;case"second":case"ss":u=B;break;case"ms":u=v;break;case"yy-mm-dd":u=C;break;case"yyyy-mm-dd":u=l;break;case"yyyy-mm-dd h:i:s ms":case"full + ms":u=l+" "+n+" "+v;break;case"full":case"yyyy-mm-dd h:i:s":default:u=l+" "+n;break}return u};return k});